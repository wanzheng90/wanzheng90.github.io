---
title: jvm-内存管理
date: 2017-04-27 10:27:29
tags: java,jvm
category: jvm
---
# jvm 内存模型
计数器:保存程序下一步执行代码位置，只是概念上的，具体实现可能不一致。
栈区:线程方法执行区，保存本地变量、引用信息和方法调用信息，每个方法调用称作一帧。线程独享
本地方法栈:调用本地方法的执行栈，jvm规范并没有定义这一块相关内容，可以与栈放在一起。线程独享
堆：共享内存区，存放对象
方法区：存放类信息和常量，可以看做堆的一部分，也需要进行垃圾回收

# jvm 内存管理
对于栈区的内存并不需要进行垃圾回收，因为栈的内存回收是在编译时确定，不需要专门处理。而堆中内存分配是在运行时动态分配的，需要专门进行管理回收。内存管理一般指对了堆内存的管理

垃圾回收的两个问题：
1、确定哪些内存是可回收的
2、如何回收内存

## 如何确定哪些内存可回收
1、引用标记法
每个对象存储一个被引用的数值，当对象被引用时数目加1，当对象失去引用时减1，当引用数目为0时，表示没有被引用，可以回收。
此方法存在问题，就是难以解决循环引用的问题

2、根引用可达
从指定的根节点集（包括栈区的对象引用、常量引用、类引用）开始搜索，如果对象从根节点不可达，则表示对象可回收
此方法存在问题，跟节点引用收集时需要暂停所有线程（stw，stop the world），以便于收集信息。其次如何确定查找引用依赖信息

## 内存回收算法
1、标记-清除法

2、复制法

3、标记-整理法


